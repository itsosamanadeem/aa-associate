<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <template id="report_invoice_document" inherit_id="account.report_invoice_document">
        <xpath expr="//table[@name='invoice_line_table']" position="replace">
            <t t-set="lines" t-value="o.invoice_line_ids.sorted(key=lambda l: (-l.sequence, l.date, l.move_name, -l.id), reverse=True)"/>
            <t t-foreach="lines" t-as="line">
                <table class="o_has_total_table table o_main_table table-borderless" name="invoice_line_ids">
                    <thead>
                        <tr>
                            <t t-set="headers" t-value="line.extra_flags.get(str(line.id))"/>
                            <t t-foreach="headers" t-as="header">
                                <th>
                                     <t t-esc="line.get_field_label(header)"/>
                                </th>
                            </t>
                        </tr>
                    </thead>
                    <tbody class="invoice_tbody">
                        <tr>
                            <t t-foreach="headers" t-as="header">
                                <td>
                                    <t t-if="line._fields.get(header) and line._fields.get(header).type == 'binary'">
                                        <img t-att-src="line.get_field_value(header)" style="height:150px; width:150px;"/>
                                    </t>
                                    <t t-else="">
                                        <t t-esc="line.get_field_value(header) or '-'"/>
                                    </t>
                                </td>
                            </t>
                        </tr>
                    </tbody>
                </table>
            </t>
        </xpath>
        <xpath expr="//div[@id='payment_term']" position="after">
            <div class="mt-5 clearfix overflow-auto" style="border: 1px solid #dee2e6; border-radius: 6px; padding: 10px; width: 100% !important;">
                <strong style="color:#4e4e4e; font-size:14px;">Service Descriptions</strong>
                <div class="mt-2" style="padding-left:8px;">
                    <t t-set="descriptions" t-value="set(o.invoice_line_ids.mapped('product_id'))"/>
                    <t t-foreach="descriptions" t-as="description">
                        <div style="margin-bottom:6px; padding:6px 10px; border-bottom:1px solid #e9ecef;">
                            <span style="font-weight:10; color:#212529;" t-out="description.name"/> :
                            <small style="color:#6c757d;">
                                <em t-out="description.product_tmpl_id.description_purchase"/>
                            </small>
                            <br/>
                        </div>
                    </t>
                </div>
            </div>
        </xpath>
    </template>
</odoo>